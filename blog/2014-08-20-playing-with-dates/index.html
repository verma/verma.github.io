<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Playing with Dates | Uday Verma's Blog</title><meta name=keywords content><meta name=description content="Clojure&rsquo;s composability to build dates using clj-time"><meta name=author content><link rel=canonical href=http://udayv.com/blog/2014-08-20-playing-with-dates/><link href=/assets/css/stylesheet.min.3dac925eb9bf5bf78d5d4e966755e4f4ae8ca86c5a9a3d1dcff2aaef78333302.css integrity="sha256-PaySXrm/W/eNXU6WZ1Xk9K6MqGxamj0dz/Kq73gzMwI=" rel="preload stylesheet" as=style><link rel=icon href=http://udayv.com/favicon.ico><link rel=icon type=image/png sizes=16x16 href=http://udayv.com/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=http://udayv.com/favicon-32x32.png><link rel=apple-touch-icon href=http://udayv.com/apple-touch-icon.png><link rel=mask-icon href=http://udayv.com/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><meta name=generator content="Hugo 0.80.0"><meta property="og:title" content="Playing with Dates"><meta property="og:description" content="Clojure&rsquo;s composability to build dates using clj-time"><meta property="og:type" content="article"><meta property="og:url" content="http://udayv.com/blog/2014-08-20-playing-with-dates/"><meta property="article:published_time" content="2014-08-20T00:00:00+00:00"><meta property="article:modified_time" content="2014-08-20T00:00:00+00:00"><meta name=twitter:card content="summary"><meta name=twitter:title content="Playing with Dates"><meta name=twitter:description content="Clojure&rsquo;s composability to build dates using clj-time"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Blogs","item":"http://udayv.com/blog/"},{"@type":"ListItem","position":2,"name":"Playing with Dates","item":"http://udayv.com/blog/2014-08-20-playing-with-dates/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"Playing with Dates","name":"Playing with Dates","description":"Clojure\u0026amp;rsquo;s composability to build dates using clj-time","keywords":[],"articleBody":"Build small self contained units of code (possibly pure) and combine them to make them do more complex stuff.\nIt fit nicely into what I was doing when playing with dates and generating histograms.\nI had to get to a certain date in the past to start building my histogram. Libraries like moment.js make it pretty trivial:\nmoment().subtract('2', 'months'); moment().subtract(moment.duration(2, 'months'))  This will give you a date 2 months ago from now.\nAlthough this works fine and I am reasonably happy with it, I find it somewhat limiting. Using Clojure (and clj-time specifically), you could do this something like:\n(- 2 months ago) which is equivalent to saying\n(ago (months 2)) Other than being easier on eyes (matter of opinion I’ve been told), we have Clojure’s composability at work here. ago and months are two functions, and not literals which have a set meaning. You can write your own functions to further extend this.\nLets say I want to clamp the time to midnight (which basically means setting hours, minutes and seconds to 0). You could write a function that just does that:\n(defn at-midnight [t] (date-midnight (year t) (month t) (day t)))) Basically, just pick the year, month and day part out of the supplied time value and construct a new date-midnight instance out of it. I can then use this function as a part of my compositional chain:\n(- 2 months ago at-midnight) which now gives you time at midnight, 2 months ago.\nReferences  clj-time - A date and time library for Clojure, wrapping the Joda Time library. cljs-time - A clj-time inspired date library for clojurescript.  ","wordCount":"269","inLanguage":"en","datePublished":"2014-08-20T00:00:00Z","dateModified":"2014-08-20T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"http://udayv.com/blog/2014-08-20-playing-with-dates/"},"publisher":{"@type":"Organization","name":"Uday Verma's Blog","logo":{"@type":"ImageObject","url":"http://udayv.com/favicon.ico"}}}</script></head><body id=top><script>if(localStorage.getItem("pref-theme")==="dark"){document.body.classList.add('dark');}else if(localStorage.getItem("pref-theme")==="light"){document.body.classList.remove('dark')}else if(window.matchMedia('(prefers-color-scheme: dark)').matches){document.body.classList.add('dark');}</script><noscript><style type=text/css>#theme-toggle,.top-link{display:none}</style></noscript><header class=header><nav class=nav><div class=logo><a href=http://udayv.com/ accesskey=h title="Uday Verma's Blog (Alt + H)">Uday Verma's Blog</a>
<span class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)"><svg id="moon" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg><svg id="sun" xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentcolor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></span></div><ul id=menu onscroll=menu_on_scroll()></ul></nav></header><main class=main><article class=post-single><header class=post-header><h1 class=post-title>Playing with Dates</h1><section class=entry-tags><p>clojure</p></section><div class=post-meta>August 20, 2014&nbsp;·&nbsp;2 min</div></header><div class=post-content><p>Build small self contained units of code (possibly pure) and combine them to make them do more complex stuff.</p><p>It fit nicely into what I was doing when playing with dates and generating histograms.</p><p>I had to get to a certain date in the past to start building my histogram. Libraries like moment.js make it pretty trivial:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-javascript data-lang=javascript><span style=color:#a6e22e>moment</span>().<span style=color:#a6e22e>subtract</span>(<span style=color:#e6db74>&#39;2&#39;</span>, <span style=color:#e6db74>&#39;months&#39;</span>);
<span style=color:#a6e22e>moment</span>().<span style=color:#a6e22e>subtract</span>(<span style=color:#a6e22e>moment</span>.<span style=color:#a6e22e>duration</span>(<span style=color:#ae81ff>2</span>, <span style=color:#e6db74>&#39;months&#39;</span>))
</code></pre></div><p>This will give you a date 2 months ago from now.</p><p>Although this works fine and I am reasonably happy with it, I find it somewhat limiting. Using Clojure (and <a href=https://github.com/clj-time/clj-time title=clj-time>clj-time</a> specifically), you could do this something like:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-clojure data-lang=clojure>(-&gt; <span style=color:#ae81ff>2</span> months ago)</code></pre></div><p>which is equivalent to saying</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-clojure data-lang=clojure>(<span style=color:#a6e22e>ago</span> (<span style=color:#a6e22e>months</span> <span style=color:#ae81ff>2</span>))</code></pre></div><p>Other than being easier on eyes (matter of opinion I&rsquo;ve been told), we have Clojure&rsquo;s composability at work here. <code>ago</code> and <code>months</code> are two functions, and not literals which have a set meaning. You can write your own functions to further extend this.</p><p>Lets say I want to clamp the time to midnight (which basically means setting hours, minutes and seconds to 0). You could write a function that just does that:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-clojure data-lang=clojure>(<span style=color:#66d9ef>defn </span>at-midnight [t]
  (<span style=color:#a6e22e>date-midnight</span> 
    (<span style=color:#a6e22e>year</span> t)
    (<span style=color:#a6e22e>month</span> t)
    (<span style=color:#a6e22e>day</span> t))))</code></pre></div><p>Basically, just pick the year, month and day part out of the supplied time value and construct a new <code>date-midnight</code> instance out of it. I can then use this function as a part of my compositional chain:</p><div class=highlight><pre style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-clojure data-lang=clojure>(-&gt; <span style=color:#ae81ff>2</span> months ago at-midnight)</code></pre></div><p>which now gives you time at midnight, 2 months ago.</p><h4 id=references>References<a hidden class=anchor aria-hidden=true href=#references>#</a></h4><ol><li><a href=https://github.com/clj-time/clj-time title=clj-time>clj-time</a> - A date and time library for Clojure, wrapping the Joda Time library.</li><li><a href=https://github.com/andrewmcveigh/cljs-time title=cljs-time>cljs-time</a> - A clj-time inspired date library for clojurescript.</li></ol></div><footer class=post-footer></footer></article></main><footer class=footer><span>&copy; 2021 <a href=http://udayv.com/>Uday Verma's Blog</a></span>
<span>&#183;</span>
<span>Powered by <a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a></span>
<span>&#183;</span>
<span>Theme <a href=https://git.io/hugopapermod rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)"><button class=top-link id=top-link type=button accesskey=g><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 12 6" fill="currentcolor"><path d="M12 6H0l6-6z"/></svg></button></a>
<script defer src=/assets/js/highlight.min.27cd435cc9ed6abb4b496581b151804f79f366c412620272bb94e2f5f598ebcc.js integrity="sha256-J81DXMntartLSWWBsVGAT3nzZsQSYgJyu5Ti9fWY68w=" onload=hljs.initHighlightingOnLoad();></script><script>window.onload=function(){if(localStorage.getItem("menu-scroll-position")){document.getElementById('menu').scrollLeft=localStorage.getItem("menu-scroll-position");}}
document.querySelectorAll('a[href^="#"]').forEach(anchor=>{anchor.addEventListener("click",function(e){e.preventDefault();var id=this.getAttribute("href").substr(1);if(!window.matchMedia('(prefers-reduced-motion: reduce)').matches){document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView({behavior:"smooth"});}else{document.querySelector(`[id='${decodeURIComponent(id)}']`).scrollIntoView();}
if(id==="top"){history.replaceState(null,null," ");}else{history.pushState(null,null,`#${id}`);}});});var mybutton=document.getElementById("top-link");window.onscroll=function(){if(document.body.scrollTop>800||document.documentElement.scrollTop>800){mybutton.style.visibility="visible";mybutton.style.opacity="1";}else{mybutton.style.visibility="hidden";mybutton.style.opacity="0";}};function menu_on_scroll(){localStorage.setItem("menu-scroll-position",document.getElementById('menu').scrollLeft);}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{if(document.body.className.includes("dark")){document.body.classList.remove('dark');localStorage.setItem("pref-theme",'light');}else{document.body.classList.add('dark');localStorage.setItem("pref-theme",'dark');}})</script></body></html>